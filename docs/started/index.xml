<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Portefaix – Getting Started</title><link>/docs/started/</link><description>Recent content in Getting Started on Portefaix</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><atom:link href="/docs/started/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Overview</title><link>/docs/started/overview/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/started/overview/</guid><description>
&lt;p>This document provides information about setting up Portefaix in various
environments.&lt;/p>
&lt;h2 id="before-you-begin">Before you begin&lt;/h2>
&lt;p>It&amp;rsquo;s important that you have some knowledge of the following systems and tools:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://terraform.io">Terraform&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kubernetes.io/docs/tutorials/kubernetes-basics/">Kubernetes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kustomize.io/">Kustomize&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://helm.sh">Helm&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Docs: Getting Started</title><link>/docs/started/getting-started/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/started/getting-started/</guid><description>
&lt;h2 id="installation">Installation&lt;/h2>
&lt;p>&lt;a id="installation-guides">&lt;/a>&lt;/p>
&lt;h2 id="installing-portefaix">Installing Portefaix&lt;/h2>
&lt;p>There are various ways to install Portefaix. Choose one of the following options
to suit your environment (public cloud, existing Kubernetes cluster, or
a single-node cluster which you can use on a desktop or server or in the cloud).&lt;/p>
&lt;p>&lt;a id="cloud">&lt;/a>&lt;/p>
&lt;h3 id="installing-portefaix-on-a-public-cloud">Installing Portefaix on a public cloud&lt;/h3>
&lt;p>Choose the Portefaix deployment guide for your chosen cloud:&lt;/p>
&lt;ul>
&lt;li>To use Portefaix on Google Kubernetes Engine (GKE),
follow the &lt;a href="/docs/gcp/deploy/">GKE deployment guide&lt;/a>.&lt;/li>
&lt;li>To use Portefaix on Amazon Elastic Kubernetes Service (EKS),
follow the &lt;a href="/docs/aws/deploy/">EKS deployment guide&lt;/a>.&lt;/li>
&lt;li>To use Portefaix on Microsoft Azure Kubernetes Service (AKS),
follow the &lt;a href="/docs/azure/deploy/">AKS deployment guide&lt;/a>.&lt;/li>
&lt;li>To use Portefaix on AlibabaCloud Container Service for Kubernetes (ACK),
follow the &lt;a href="/docs/alicloud/deploy">ACK deployment guide&lt;/a>.&lt;/li>
&lt;/ul>
&lt;!-- * To use Portefaix on IBM Cloud (IKS),
follow the [IKS deployment guide](/docs/ibm/).
* To use Portefaix on IBM Cloud (IKS),
follow the [IKS deployment guide](/docs/ibm/).
* To use Portefaix on IBM Cloud (IKS),
follow the [IKS deployment guide](/docs/ibm/). -->
&lt;h2 id="deployment-quick-reference">Deployment quick reference&lt;/h2>
&lt;p>Below is a matrix of the platforms where you can deploy Portefaix and the
corresponding tools for each platform.&lt;/p>
&lt;div class="table-responsive">
&lt;table class="table table-bordered">
&lt;thead class="thead-light">
&lt;tr>
&lt;th>Cloud Provider&lt;/th>
&lt;th>Sops&lt;/th>
&lt;th>Tfsec&lt;/th>
&lt;th>Inspec&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Google Cloud Platform&lt;/td>
&lt;td>&lt;a href="https://cloud.google.com/security-key-management"> GCP KMS &lt;/a>&lt;/td>
&lt;td>&lt;i class="fas fa-check">&lt;/i>&lt;/td>
&lt;td>&lt;i class="fas fa-check">&lt;/i>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Amazon AWS&lt;/td>
&lt;td>&lt;a href="https://aws.amazon.com/kms/">AWS KMS&lt;/a>&lt;/td>
&lt;td>&lt;i class="fas fa-check">&lt;/i>&lt;/td>
&lt;td>&lt;i class="fas fa-check">&lt;/i>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Microsoft Azure&lt;/td>
&lt;td>&lt;a href="https://azure.microsoft.com/en-us/services/key-vault/">Azure KeyVault&lt;/a>&lt;/td>
&lt;td>&lt;i class="fas fa-check">&lt;/i>&lt;/td>
&lt;td>&lt;i class="fas fa-check">&lt;/i>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>AlibabaCloud&lt;/td>
&lt;td>&lt;a href="https://www.openpgp.org/">OpenPGP&lt;/a>&lt;/td>
&lt;td>&lt;i class="fas fa-times">&lt;/i>&lt;/td>
&lt;td>&lt;i class="fas fa-times">&lt;/i>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Scaleway&lt;/td>
&lt;td>&lt;a href="https://www.openpgp.org/">OpenPGP&lt;/a>&lt;/td>
&lt;td>&lt;i class="fas fa-times">&lt;/i>&lt;/td>
&lt;td>&lt;i class="fas fa-times">&lt;/i>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Digital Ocean&lt;/td>
&lt;td>&lt;a href="https://www.openpgp.org/">OpenPGP&lt;/a>&lt;/td>
&lt;td>&lt;i class="fas fa-times">&lt;/i>&lt;/td>
&lt;td>&lt;i class="fas fa-times">&lt;/i>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;h2 id="troubleshooting">Troubleshooting&lt;/h2>
&lt;p>See the &lt;a href="/docs/other-guides/troubleshooting/">Portefaix troubleshooting guide&lt;/a>.&lt;/p></description></item><item><title>Docs: Secrets</title><link>/docs/started/secrets/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/started/secrets/</guid><description>
&lt;h2 id="secrets">Secrets&lt;/h2>
&lt;p>&lt;a href="https://github.com/mozilla/sops">Sops&lt;/a> is used to manage secrets.&lt;/p>
&lt;h3 id="store">Store&lt;/h3>
&lt;p>Put your sensitive data into the directory &lt;code>.secrets&lt;/code> or &lt;code>.secrets/&amp;lt;CLOUD_PROVIDER&amp;gt;&lt;/code>&lt;/p>
&lt;h3 id="kubernetes-secret">Kubernetes secret&lt;/h3>
&lt;p>Create a Kubernetes secret file from sensitive file.&lt;/p>
&lt;p>Ex: for Thanos configuration :&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#000">❯ cat .secrets/aws/object-store.yaml&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">type&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">S3&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">&lt;/span>&lt;span style="color:#204a87;font-weight:bold">config&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">bucket&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">xxxxxxxxxxx&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">endpoint&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">s3.eu-west-3.amazonaws.com&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#204a87;font-weight:bold">region&lt;/span>&lt;span style="color:#000;font-weight:bold">:&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline"> &lt;/span>&lt;span style="color:#000">eu-west-3&lt;/span>&lt;span style="color:#f8f8f8;text-decoration:underline">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ make kubernetes-secret &lt;span style="color:#000">NAME&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>thanos-object-storage &lt;span style="color:#000">NAMESPACE&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>monitoring &lt;span style="color:#000">FILE&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>.secrets/aws/object-store.yaml &amp;gt; thanos-object-storage.yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="encrypt">Encrypt&lt;/h3>
&lt;p>Encrypt the file using Sops:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ make sops-encrypt &lt;span style="color:#000">ENV&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>staging &lt;span style="color:#000">CLOUD&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>aws &lt;span style="color:#000">FILE&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>thanos-object-storage.yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can now safely store this file into Git.&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ mv thanos-object-storage.yaml kubernetes/overlays/staging/monitoring/thanos/
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="decrypt">Decrypt&lt;/h3>
&lt;p>Check you can decrypt the file:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ make sops-decrypt &lt;span style="color:#000">FILE&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>kubernetes/overlays/staging/monitoring/thanos/thanos-object-storage.yaml
apiVersion: v1
data:
object-store.yaml: xxxxxxxxxxx
kind: Secret
metadata:
creationTimestamp: null
name: thanos-object-storage
namespace: monitoring
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="cicd">CICD&lt;/h2>
&lt;p>Generate a GPG key with OpenPGP without specifying a passphrase:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ gpg --full-generate-key
Real name: nlamirault
Email address: nlamirault@users.noreply.github.com
Comment:
You selected this USER-ID:
&lt;span style="color:#4e9a06">&amp;#34;nlamirault &amp;lt;nlamirault@users.noreply.github.com&amp;gt;&amp;#34;&lt;/span>
Change &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>N&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>ame, &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>C&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>omment, &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>E&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>mail or &lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>O&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>kay/&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>Q&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>uit? O
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Retrieve the GPG key ID:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ gpg --export-secret-keys &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span>--armor FC5BB3323309486AC8DA477CEC6421C7C33D2301
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Add this output into a Github Secret &lt;code>SOPS_GPG_KEY&lt;/code>.&lt;/p>
&lt;p>On the &lt;code>e2e&lt;/code> Github Action workflow, we create a Kubernetes secret &lt;code>sops-gpg&lt;/code>
which will be used by Flux.&lt;/p></description></item><item><title>Docs: Gitops</title><link>/docs/started/gitops/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/started/gitops/</guid><description>
&lt;p>&lt;a href="https://www.weave.works/technologies/gitops/">Gitops&lt;/a> model used is &lt;a href="https://toolkit.fluxcd.io/">Flux v2&lt;/a>&lt;/p>
&lt;p>&lt;img src="/docs/images/gitops-toolkit.png"
alt="Flux v2"
class="mt-3 mb-3 border border-info rounded">&lt;/p>
&lt;h2 id="organization">Organization&lt;/h2>
&lt;p>Manifests files :&lt;/p>
&lt;ul>
&lt;li>&lt;code>kubernetes/base&lt;/code> directory contains manifests for all components&lt;/li>
&lt;li>&lt;code>kubernetes/overlays/**&lt;/code> directory contains &lt;a href="https://kustomize.io/">Kustomize&lt;/a> overlays&lt;/li>
&lt;/ul>
&lt;p>Flux components are deployed for each clusster on &lt;code>clusters/&amp;lt;CLOUD&amp;gt;/&amp;lt;ENV&amp;gt;/&lt;/code> :&lt;/p>
&lt;ul>
&lt;li>&lt;code>clusters/&amp;lt;CLOUD&amp;gt;/&amp;lt;ENV&amp;gt;/flux-system&lt;/code> : Flux core components&lt;/li>
&lt;li>&lt;code>clusters/&amp;lt;CLOUD&amp;gt;/&amp;lt;ENV&amp;gt;/*.yaml&lt;/code> : &lt;a href="https://toolkit.fluxcd.io/components/kustomize/kustomization/">Flux Kustomization&lt;/a> files for components&lt;/li>
&lt;/ul>
&lt;h2 id="sync">Sync&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ make gitops-bootstrap &lt;span style="color:#000">ENV&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&amp;lt;ENV&amp;gt; &lt;span style="color:#000">CLOUD&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&amp;lt;CLOUD PROVIDER&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: Terraform</title><link>/docs/started/terraform/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/started/terraform/</guid><description>
&lt;p>The &lt;a href="https://registry.terraform.io/providers/hashicorp/helm/latest/docs">Terraform Helm provider&lt;/a> could be use to deploy applications.&lt;/p>
&lt;h2 id="organization">Organization&lt;/h2>
&lt;p>Kubernetes applications configurations are located in &lt;code>iac/&amp;lt;CLOUD PROVIDER&amp;gt;/kubernetes&lt;/code>.&lt;/p>
&lt;h2 id="actions">Actions&lt;/h2>
&lt;h3 id="create">Create&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ make terraform-apply &lt;span style="color:#000">SERVICE&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>iac/&amp;lt;CLOUD_PROVIDER&amp;gt;/kubernetes/&amp;lt;NAMESPACE&amp;gt;/&amp;lt;APP&amp;gt; &lt;span style="color:#000">ENV&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&amp;lt;ENVIRONMENT&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="destroy">Destroy&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">❯ make terraform-destroy &lt;span style="color:#000">SERVICE&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>iac/&amp;lt;CLOUD_PROVIDER&amp;gt;/kubernetes/&amp;lt;NAMESPACE&amp;gt;/&amp;lt;APP&amp;gt; &lt;span style="color:#000">ENV&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&amp;lt;ENVIRONMENT&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>